# 游戏设计文档 (GDD): 《地球新主》

**项目代号**: EarthLord
**游戏类型**: LBS策略建造游戏
**目标平台**: iOS (首发), Android (未来)
**目标用户**: 18-35岁喜欢户外运动的策略游戏玩家
**文档版本**: 1.0
**最后更新**: 2026年1月

---

## 目录

1. [游戏愿景](#1-游戏愿景)
2. [世界观与叙事](#2-世界观与叙事)
3. [核心游戏玩法](#3-核心游戏玩法)
4. [游戏系统详解](#4-游戏系统详解)
5. [进度与成长系统](#5-进度与成长系统)
6. [社交与多人互动](#6-社交与多人互动)
7. [视觉与音效设计](#7-视觉与音效设计)
8. [技术方案](#8-技术方案)
9. [盈利模式](#9-盈利模式)
10. [开发路线图](#10-开发路线图)

---

## 1. 游戏愿景

### 1.1 一句话概述

> 这是一款基于GPS的末世题材户外策略游戏,玩家通过在现实世界中步行来圈占虚拟土地,重建文明,并在一个与现实平行的废土世界上,体验探索、创造与社交的乐趣。

### 1.2 核心支柱 (Core Pillars)

#### 支柱 1: 探索与开拓 (Explore & Reclaim)

激励玩家走出家门,用脚步丈量世界。每一步都是在末世废土上的开拓,每一块领地都是用汗水换来的成就。游戏将真实世界的地理与虚拟废土重叠,让玩家用全新的视角重新认识自己生活的城市。

**设计体现**:
- 真实步行才能圈地,无法作弊
- 领地面积直观可视化成就感
- 探索废墟获得稀有资源

#### 支柱 2: 策略与博弈 (Strategize & Compete)

核心圈地机制简单易懂,但"路径不可交叉"的规则带来无限策略深度。玩家需要规划最优路线,避开其他玩家的领地,在有限的时间和体力下圈占最有价值的土地。

**设计体现**:
- 路径碰撞检测系统
- 地形和资源分布影响价值
- 多人竞争同一区域的博弈

#### 支柱 3: 建造与繁荣 (Build & Prosper)

在自己辛苦圈下的土地上,从零开始建立定居点。看着一片废墟慢慢变成繁荣的家园,这种长期成就感是游戏的核心动力。

**设计体现**:
- 15种不同功能建筑
- 建筑间的协同效应
- 视觉上的繁荣感(从荒地到城镇)

#### 支柱 4: 社交与协作 (Socialize & Collaborate)

这不是一个人的末世。通过无线电系统,玩家可以与附近的幸存者交流,组建联盟,共同完成宏伟的重建计划。

**设计体现**:
- 本地无线电(3km)
- 资源交易系统
- 联盟领地共建(Phase 2)

### 1.3 目标用户

#### 核心用户画像

**用户群 1: LBS游戏爱好者**
- 玩过Pokemon GO、Ingress等LBS游戏
- 对"现实世界+虚拟游戏"的结合感兴趣
- 需求: 比Pokemon GO更有深度的LBS体验

**用户群 2: 末世生存游戏粉丝**
- 喜欢《辐射》、《这是我的战争》等末世题材
- 喜欢建造和资源管理
- 需求: 移动端的深度策略建造体验

**用户群 3: 健身激励者**
- 希望通过游戏化激励自己运动
- 愿意为有意义的游戏目标而行走
- 需求: 将日常运动转化为游戏成就

**用户群 4: 元宇宙探索者**
- 对虚拟资产ownership感兴趣
- 喜欢在虚拟世界中拥有"自己的土地"
- 需求: 真实感的虚拟地产体验

---

## 2. 世界观与叙事

### 2.1 背景故事

#### 灾难前夜 (2040-2048)

2040年代,全球资源枯竭和气候危机引发了一系列冲突。最初是小规模的领土争端,但随着粮食和水资源的进一步短缺,冲突迅速升级。

2048年3月,历史将这一天称为"终末之日",多个核大国几乎同时按下了按钮。短短72小时内,全球主要城市被核火覆盖。文明延续数千年的秩序在三天内崩塌。

#### 黑暗时代 (2048-2051)

战后的三年是真正的地狱。地表被辐射和核冬天覆盖,95%的人类在战争和随后的饥荒、疾病中死去。幸存者躲藏在地下掩体、地铁站、矿井中,依靠战前储备的物资艰难生存。

所有现代交通工具(汽车、飞机、火车)因为燃料耗尽和电磁脉冲损坏而失效。电力网络全面崩溃。人类退回到了最原始的状态——只能依靠双脚行走。

#### 重生的曙光 (2051年至今)

2051年春天,第一批幸存者从地下走出。令人惊讶的是,地表的辐射水平已经降到可以短时间活动的程度。大自然展现出惊人的恢复力,废墟中开始长出绿色植物。

联合幸存者政府(USG, United Survivors Government)由全球各地的幸存者聚落组成。他们颁布了具有历史意义的《地球新生法案》,核心内容是"新开拓者协议":

> **"凡以双足丈量之无主土地,皆为开拓者所有。"**
> "All unclaimed land measured by foot shall belong to the reclaimers."

这不是复古的浪漫主义,而是残酷的现实——没有交通工具,唯一可以真正"占有"土地的方式,就是用双脚走过去。

#### 现在 (2051年夏天)

你是一名幸存者,刚刚从地下掩体走出。你的背包里只有一个手持GPS终端(奇迹般地在EMP中幸存),一些基础工具,和为期三天的补给。

你面前是一片废墟,但也是无限可能。在这个新世界,土地不再属于权贵,而是属于那些有勇气走出去的人。

### 2.2 世界设定

#### 游戏世界 (The Game World)

《地球新主》的世界与现实世界完全重叠,但所有人造物都已成为废墟:

- **城市**: 高楼变成骨架,被植被覆盖
- **道路**: 依然可见,但破损严重,长满野草
- **河流/山脉**: 自然地形保持不变
- **天气**: 与现实世界同步(使用实时天气API)

#### 资源分布逻辑

不同类型的真实世界POI对应不同的废墟类型:

| 真实世界POI | 废墟类型 | 主要资源 |
|------------|---------|---------|
| 住宅区 | 住宅废墟 | 废料、木材 |
| 医院 | 医院废墟 | 医疗用品、电子元件 |
| 工厂 | 工厂废墟 | 金属、机械零件 |
| 超市 | 超市废墟 | 食物、水(极稀缺) |
| 学校 | 学校废墟 | 书籍、文具(Phase 2) |
| 军事基地 | 军事废墟 | 高级材料、武器零件 |

#### 时间系统

- 游戏世界与现实时间同步
- 昼夜循环影响视觉效果(夜晚地图更暗,建筑灯光更明显)
- 某些事件只在特定时间发生(Phase 2)

### 2.3 视觉风格

#### 整体风格: "希望朋克 (Hopepunk)"

有别于传统末世游戏的绝望和黑暗,《地球新主》采用"希望朋克"美学:

- **废土的苍凉**: 灰色的废墟,生锈的金属,破碎的道路
- **生命的顽强**: 绿色植物从废墟中生长,蓝天白云,温暖的阳光
- **重建的希望**: 玩家建筑散发温暖的灯光,明亮的色彩

#### 色彩方案

**主色调**:
- 主题色: 橙色 `#FF6B35` (象征希望之火)
- 背景色: 深灰 `#1A1A2E` (末世废土)
- 文字色: 浅灰 `#E8E8E8` (清晰可读)
- 强调色: 金色 `#FFD700` (领地边界)

**地图色彩**:
- 降低饱和度20%营造末世感
- 玩家领地高亮显示(金色边界+半透明填充)
- 其他玩家领地低调显示(灰色半透明)

#### UI风格

- **未来感+废土感结合**: 类似《辐射》的Pip-Boy界面
- **扁平化设计**: 简洁清晰,适合户外阳光下查看
- **大按钮**: 适合行走时操作(无需精确点击)

---

## 3. 核心游戏玩法

### 3.1 核心循环 (Core Loop)

```
步行探索
    ↓
圈占领地
    ↓
搜刮资源
    ↓
建造建筑
    ↓
收集产出
    ↓
扩张领土 → 返回"步行探索"
```

#### 会话级循环 (Session Loop, 15-30分钟)
1. 打开游戏,查看地图
2. 规划今天的探索路线
3. 开启"开拓模式",步行圈地
4. 在路上探索2-3个废墟
5. 返回领地,建造/升级建筑
6. 收集建筑产出
7. 在无线电频道聊天

#### 日循环 (Daily Loop)
- 早上: 通勤时圈占新领地
- 中午: 探索公司附近的废墟
- 晚上: 收集建筑产出,规划建造

#### 周循环 (Weekly Loop)
- 工作日: 小规模圈地,维护现有领地
- 周末: 远征探索,圈占大面积领地

#### 长期循环 (Long-term Loop)
- 从单个小领地 → 连片大领地
- 从简单建筑 → 复杂生产链
- 从独狼玩家 → 联盟领袖

### 3.2 圈地系统 (Territory Claiming)

#### 3.2.1 核心机制

**开拓模式**:
- 玩家点击"开始开拓"按钮
- App开始记录GPS轨迹(蓝色路径线)
- 实时显示当前路径、距离、时间
- 形成闭环后点击"完成开拓"

**闭环判定**:
- 起点和终点直线距离 <20米
- 至少20个有效GPS点
- 路径不自相交(不能走8字形)

**服务器验证**:
1. 路径是否简单(不自相交)
2. 是否与其他玩家领地/路径相交
3. 面积是否在合理范围(0.01-5km²)
4. 速度是否符合步行(<15km/h平均速度)

**成功圈地**:
- 领地显示在地图上(金色边界)
- 显示领地面积和获得的"开拓点数"
- 解锁在该领地内建造的权限

#### 3.2.2 策略深度

**领地价值评估**:
并非所有土地价值相等,以下因素影响领地价值:

| 因素 | 价值影响 |
|------|---------|
| POI密度 | 高密度区域更有价值(更多资源) |
| 地形 | 平地易圈,但山区资源更丰富 |
| 竞争程度 | 城市中心竞争激烈,郊区更易圈占 |
| 连通性 | 与现有领地相连可形成领地网络 |

**路径规划技巧**:
- **最小化重复**: 规划不走回头路的闭环
- **避开冲突**: 观察地图上其他玩家领地,规划空隙路线
- **资源优先**: 圈占包含多个POI的区域
- **形状优化**: 圆形/方形领地面积利用率最高

#### 3.2.3 反作弊机制

**速度检测**:
- 实时计算相邻点间速度
- 任一段 >30km/h 标记为异常
- 平均速度 >15km/h 拒绝验证

**传感器融合**:
- 结合加速度计数据检测真实步行
- 检测模拟器特征(GPS漂移过于平滑)

**行为分析**:
- 异常大面积圈地(单次>2km²)触发人工审核
- 短时间多次圈地限制

**惩罚机制**:
- 首次作弊: 警告,删除该领地
- 重复作弊: 账号暂停3天
- 严重作弊: 永久封禁

### 3.3 探索与搜刮系统 (Exploration & Scavenging)

#### 3.3.1 POI发现

**可见范围**:
- 免费用户: 1km范围内POI可见
- 订阅用户: 2km范围(Phase 2)

**POI图标**:
每种废墟类型有独特图标:
- 住宅废墟: 房屋图标(灰色)
- 医院废墟: 十字架图标(红色)
- 工厂废墟: 齿轮图标(棕色)
- 超市废墟: 购物车图标(绿色)
- 军事废墟: 盾牌图标(黑色,稀有)

**信息显示**:
点击POI显示:
- 废墟名称(如"人民医院废墟")
- 距离当前位置
- 主要资源类型
- 下次可搜刮时间(冷却中)

#### 3.3.2 搜刮流程

**接近阶段**:
- 距离 >50米: "搜刮"按钮灰色,显示"靠近后可搜刮"
- 距离 <50米: 按钮激活(橙色)

**搜刮动画** (3秒):
1. 角色进入废墟(淡入效果)
2. 播放搜索动画(翻找物品的图标)
3. 物品逐个弹出

**奖励显示**:
```
【搜刮成功】
获得:
+ 废料 x5
+ 电子元件 x2
+ 医疗用品 x1 (稀有!)
```

**冷却机制**:
- 每个POI有独立冷却时间
- 住宅/超市: 6小时
- 医院/工厂: 12小时
- 军事: 24小时
- 冷却期间显示倒计时

#### 3.3.3 掉落机制

**加权随机算法**:

```javascript
// 示例: 医院废墟掉落表
{
  "common": [
    {"item": "scrap", "weight": 40, "quantity": [2,5]},
    {"item": "bandage", "weight": 30, "quantity": [1,3]}
  ],
  "rare": [
    {"item": "electronics", "weight": 20, "quantity": [1,2]},
    {"item": "medicine", "weight": 8, "quantity": [1,1]}
  ],
  "epic": [
    {"item": "surgical_kit", "weight": 2, "quantity": [1,1]}
  ]
}
```

**品质分级**:
- 普通(白色): 70%概率
- 稀有(蓝色): 25%概率
- 史诗(紫色): 5%概率
- 传奇(金色): <1%概率 (Phase 2)

**每日限制**:
- 免费用户: 20次/天
- 订阅用户: 无限次
- 达到上限后提示: "今日探索次数已用完,订阅可解锁无限探索"

---

## 4. 游戏系统详解

### 4.1 资源系统 (Resource System)

#### 4.1.1 资源分类

**基础资源** (用于建造):
| 资源 | 图标 | 主要来源 | 用途 |
|------|------|---------|------|
| 废料 (Scrap) | 金属片 | 住宅/工厂废墟 | 基础建造材料 |
| 木材 (Wood) | 木板 | 住宅废墟/树木 | 基础建造材料 |
| 金属 (Metal) | 钢材 | 工厂废墟 | 高级建造材料 |
| 电子元件 (Electronics) | 芯片 | 医院/工厂废墟 | 高科技建筑 |

**生存资源** (Phase 2):
| 资源 | 图标 | 主要来源 | 用途 |
|------|------|---------|------|
| 食物 (Food) | 罐头 | 超市废墟 | 维持生命 |
| 水 (Water) | 水瓶 | 超市/庇护所产出 | 维持生命 |
| 医疗用品 (Medicine) | 药箱 | 医院废墟 | 治疗伤病 |

**稀有材料** (Phase 2):
| 资源 | 图标 | 主要来源 | 用途 |
|------|------|---------|------|
| 稀有金属 (Rare Metal) | 钛合金 | 军事废墟 | 顶级建筑 |
| 高级芯片 (Advanced Chip) | CPU | 军事/科研废墟 | 高科技设施 |
| 燃料 (Fuel) | 油桶 | 加油站废墟 | 发电机 |

#### 4.1.2 背包管理

**容量系统**:
- 基础容量: 100格
- 仓库建筑: 每个+50格
- 订阅用户: 额外+100格

**堆叠规则**:
- 相同物品自动堆叠
- 每格最多999个
- 不可堆叠物品(武器/装备,Phase 2)占单格

**整理功能**:
- 自动整理: 按类型/数量排序
- 筛选: 显示特定类型物品
- 收藏: 标记常用物品

### 4.2 建造系统 (Building System)

#### 4.2.1 建筑分类

**生存类建筑**:

| 建筑 | 等级 | 所需资源 | 建造时间 | 功能 | 占地 |
|------|------|---------|---------|------|------|
| 庇护所 (Shelter) | 1 | 废料x10, 木材x5 | 2h | 生产水x2/h | 100㎡ |
| | 2 | 金属x20, 木材x10 | 4h | 生产水x5/h | 100㎡ |
| | 3 | 金属x40, 电子元件x5 | 8h | 生产水x10/h, 食物x2/h | 100㎡ |

| 雨水收集器 | 1 | 金属x15, 废料x20 | 3h | 生产水x4/h | 50㎡ |

**生产类建筑**:

| 建筑 | 所需资源 | 建造时间 | 功能 |
|------|---------|---------|------|
| 工作台 (Workbench) | 废料x20, 金属x10 | 4h | 解锁物品合成 |
| 精炼厂 (Refinery) | 金属x30, 电子元件x10 | 6h | 废料→金属转化 |
| 电子工坊 (Electronics Lab) | 金属x40, 电子元件x20 | 8h | 生产电子元件 |

**功能类建筑**:

| 建筑 | 所需资源 | 建造时间 | 功能 |
|------|---------|---------|------|
| 仓库 (Warehouse) | 木材x15, 金属x5 | 3h | 背包容量+50 |
| 瞭望塔 (Watchtower) | 木材x25, 金属x15 | 5h | POI探索范围+500m |
| 发电机 (Generator) | 金属x30, 电子元件x10 | 6h | 所有建筑建造速度+20% |
| 中继电台 (Radio Tower) | 金属x50, 电子元件x30 | 10h | 解锁30km无线电(订阅) |

**防御类建筑** (Phase 2):

| 建筑 | 功能 |
|------|------|
| 围墙 (Wall) | 保护领地边界 |
| 哨塔 (Guard Tower) | 自动防御入侵 |
| 陷阱 (Trap) | 减缓入侵速度 |

#### 4.2.2 建造流程

**步骤1: 选择位置**
- 只能在自己的领地内建造
- 长按地图空白处,弹出"放置建筑"菜单
- 显示建筑占地预览(半透明圆圈)
- 拖动调整位置,确保不与现有建筑重叠

**步骤2: 选择建筑类型**
- 分类浏览建筑(生存/生产/功能)
- 显示每个建筑的:
  - 图标和名称
  - 所需资源(红色=不足,绿色=充足)
  - 建造时间
  - 功能描述
- 点击"建造"确认

**步骤3: 建造中**
- 地图上显示"建造中"图标(灰色+进度条)
- 建筑列表显示剩余时间
- 可以点击查看详情
- Phase 2支持:
  - 消耗"加速器"道具立即完成
  - 付费加速

**步骤4: 完成**
- 推送通知: "你的庇护所已建造完成!"
- 图标变为彩色完整图标
- 开始发挥功能(如生产资源)

#### 4.2.3 建筑协同效应

某些建筑组合会产生额外效果:

**生产链优化**:
- 庇护所 + 雨水收集器(相邻) → 水产出+50%
- 工作台 + 电子工坊(同一领地) → 合成电子物品时材料-20%

**范围增益**:
- 发电机(200米范围) → 所有建筑建造/生产速度+20%
- 瞭望塔(500米范围) → POI探索范围增加

**主题奖励** (Phase 2):
- 集齐"工业主题"所有建筑(工作台/精炼厂/电子工坊) → 解锁"工业城镇"称号,所有生产速度+10%

#### 4.2.4 建筑升级

**升级机制**:
- 每个建筑可升级到3级
- 每级提升产出/效果,但所需资源指数增长
- 升级时间 = 建造时间 × 当前等级

**示例: 庇护所升级**
| 等级 | 水产出 | 食物产出 | 升级资源 | 升级时间 |
|------|--------|---------|---------|---------|
| 1 | 2/h | - | - | - |
| 2 | 5/h | - | 金属x20, 木材x10 | 4h |
| 3 | 10/h | 2/h | 金属x40, 电子元件x5 | 8h |

#### 4.2.5 建筑拆除

**拆除流程**:
- 长按建筑图标 → 选择"拆除"
- 弹出确认对话框(显示返还资源)
- 确认后立即完成,返还50%建造资源

**策略意义**:
- 调整领地布局
- 回收资源用于更高级建筑
- 清理不需要的建筑

### 4.3 生产与收集系统

#### 4.3.1 生产机制

**时基生产**:
- 建筑完成后立即开始生产
- 按小时计算产出(如庇护所2个水/小时)
- 服务器端计时,客户端定期同步

**储存上限**:
- 每个建筑最多储存24小时产出
- 超过上限停止生产
- 鼓励玩家每天至少登录一次

**产出计算公式**:
```
产出数量 = 基础产出/小时 × 经过小时数 × (1 + 建筑等级加成 + 协同效应加成)
储存数量 = min(计算产出, 24小时上限)
```

#### 4.3.2 收集流程

**手动收集**:
- 点击建筑图标 → 查看可收集资源
- 点击"收集"按钮
- 播放收集动画(资源飞入背包图标)
- 显示"已收集"标记

**一键收集** (Phase 2):
- 领地详情页面"一键收集所有"按钮
- 自动收集该领地所有建筑产出

**离线收益**:
- 玩家离线期间建筑继续生产
- 登录时自动计算离线收益
- 显示"离线收益报告":
  ```
  【欢迎回来!】
  离线时间: 8小时23分钟

  离线收益:
  + 水 x42 (来自3个庇护所)
  + 食物 x16 (来自2个庇护所)
  + 电子元件 x8 (来自电子工坊)

  部分建筑已达储存上限,请及时收集!
  ```

### 4.4 合成系统 (Phase 2)

需要先建造"工作台",才能解锁合成功能。

#### 4.4.1 合成配方

**基础合成**:
| 产物 | 所需材料 | 合成时间 |
|------|---------|---------|
| 木板 x2 | 废料x5 → 木材x2 | 即时 |
| 金属板 x1 | 废料x10 → 金属x1 | 5分钟 |
| 基础工具 x1 | 废料x5, 木材x3 → 工具x1 | 10分钟 |

**高级合成** (需要电子工坊):
| 产物 | 所需材料 | 合成时间 |
|------|---------|---------|
| 电路板 x1 | 金属x5, 电子元件x2 | 30分钟 |
| 太阳能板 x1 | 金属x10, 电子元件x5 | 1小时 |

**稀有合成** (需要高级工坊):
| 产物 | 所需材料 | 合成时间 |
|------|---------|---------|
| 能量核心 x1 | 稀有金属x5, 高级芯片x3 | 2小时 |

---

## 5. 进度与成长系统

### 5.1 玩家等级系统

#### 5.1.1 经验值获取

| 行为 | 经验值 | 备注 |
|------|--------|------|
| 成功圈地 | 面积(km²) × 100 | 0.5km² = 50 EXP |
| 搜刮废墟 | 10 EXP | 每次搜刮 |
| 建造建筑 | 建造时间(小时) × 20 | 2小时建筑 = 40 EXP |
| 升级建筑 | 建筑等级 × 50 | 升到2级 = 100 EXP |
| 完成成就 | 50-500 EXP | 根据成就难度 |

#### 5.1.2 等级奖励

| 等级 | 所需总经验 | 奖励 |
|------|-----------|------|
| 1 | 0 | - |
| 2 | 100 | 背包容量+10 |
| 5 | 500 | 解锁"工作台"建筑 |
| 10 | 2,000 | 每日搜刮次数+5 |
| 15 | 5,000 | 解锁"中继电台"建筑 |
| 20 | 10,000 | 解锁"精炼厂"建筑 |
| 25 | 20,000 | 背包容量+20 |
| 30 | 40,000 | 解锁稀有建筑蓝图 |

### 5.2 成就系统

#### 5.2.1 成就类别

**探索类成就**:
- **幸存者的第一步**: 完成第一次圈地 (奖励: 废料x50)
- **开拓先锋**: 累计圈地面积10km² (奖励: 称号"开拓者")
- **领土霸主**: 累计圈地面积100km² (奖励: 称号"领主")
- **废土行者**: 步行累计100km (奖励: 背包容量+20)
- **马拉松勇士**: 单次圈地步行超过20km (奖励: 传奇资源包)

**建造类成就**:
- **重建之始**: 建造第一个庇护所 (奖励: 水x50)
- **城市建设者**: 拥有10个建筑 (奖励: 建造加速器x3)
- **文明之光**: 建造所有类型建筑各1个 (奖励: 称号"建设大师")
- **高塔建造者**: 建筑升到3级 (奖励: 高级材料包)
- **繁荣都市**: 单个领地内有20个建筑 (奖励: 称号"都市规划师")

**探索类成就**:
- **拾荒者**: 搜刮100次POI (奖励: 探索范围+200m)
- **宝藏猎人**: 获得10个史诗级物品 (奖励: 稀有物品掉落率+5%)
- **全地图探索者**: 探索过10种不同类型的废墟 (奖励: 称号"探险家")

**社交类成就** (Phase 2):
- **初次接触**: 发送第一条无线电消息
- **社交达人**: 与50名不同玩家交流
- **联盟创始人**: 创建联盟
- **贸易大亨**: 完成100笔交易

#### 5.2.2 称号系统

解锁成就可获得称号,显示在昵称旁:

**称号示例**:
- [开拓者] 昵称 - 金色
- [领主] 昵称 - 紫色
- [建设大师] 昵称 - 蓝色

**称号效果** (纯视觉,不影响游戏平衡):
- 不同颜色边框
- 聊天时特殊图标
- 个人主页展示

---

## 6. 社交与多人互动

### 6.1 无线电通讯系统

#### 6.1.1 频道类型

**本地频道** (免费):
- 范围: 3km
- 用途: 与附近玩家交流
- 使用场景: "这个公园适合圈地吗?", "谁知道附近的医院废墟位置?"

**区域频道** (订阅解锁):
- 范围: 30km
- 用途: 城市级别交流
- 使用场景: 组织联盟活动,区域贸易

**全球频道** (Phase 2):
- 范围: 无限制
- 用途: 全球玩家交流
- 使用场景: 展示成就,分享攻略

**私人频道** (Phase 2):
- 1对1私聊
- 联盟专属频道

#### 6.1.2 消息功能

**文字消息**:
- 最多200字符
- 支持emoji (有限集合,避免审核问题)
- 敏感词自动过滤

**快捷消息**:
预设常用语句,一键发送:
- "需要帮助!"
- "这里有资源!"
- "小心这个区域!"
- "想组队探索"

**位置标记**:
- 可分享当前位置或标记地图上某个点
- 显示为可点击的地图标记
- 点击后打开地图并居中显示该位置

#### 6.1.3 反作弊与审核

**敏感词过滤**:
- 基于本地词库实时过滤
- 过滤后显示为"***"

**频率限制**:
- 10秒内最多发送1条消息
- 1分钟内最多5条消息
- 违反限制显示"发送过快,请稍后再试"

**举报功能**:
- 长按消息 → "举报"
- 举报理由: 垃圾信息/骚扰/不当内容
- 累计被举报3次自动禁言24小时
- 人工审核严重违规者永久封禁

### 6.2 好友系统 (Phase 2)

#### 6.2.1 添加好友

**添加方式**:
- 通过用户ID搜索
- 附近玩家列表(显示1km内在线玩家)
- 扫描二维码
- 无线电消息中点击头像

**好友上限**:
- 免费用户: 50人
- 订阅用户: 200人

#### 6.2.2 好友互动

**查看好友信息**:
- 领地总面积
- 建筑数量
- 等级和成就
- 最后在线时间

**好友助力** (每日1次):
- 点击"助力"按钮,赠送好友少量资源
- 被助力方收到通知

**好友排行榜**:
- 按领地面积排名
- 按建筑数量排名
- 按等级排名

### 6.3 联盟系统 (Phase 2)

#### 6.3.1 创建与加入

**创建联盟**:
- 等级10解锁
- 消耗: 金属x100, 电子元件x50
- 设置联盟名称、标志、简介

**加入联盟**:
- 搜索联盟列表
- 申请加入(需会长/副会长批准)
- 或通过邀请链接直接加入

**联盟规模**:
- 初始容量: 20人
- 通过升级联盟大厅扩容(最多200人)

#### 6.3.2 联盟功能

**联盟领地**:
- 成员可以在联盟指定区域共同建造
- 联盟建筑(联盟大厅、联盟仓库、联盟防御塔)
- 所有成员共享收益

**联盟任务**:
- 每周刷新联盟任务
- 示例: "成员累计圈地100km²", "建造50个建筑"
- 完成奖励全联盟成员

**联盟战争** (Phase 3):
- 联盟之间争夺特定区域控制权
- 胜利方获得该区域资源产出加成

### 6.4 交易系统 (Phase 2)

#### 6.4.1 点对点交易

**发起交易**:
- 与附近玩家(1km内)发起交易请求
- 双方放入要交易的物品
- 双方确认后完成交易

**交易限制**:
- 每天最多10笔交易
- 单笔交易最多5种物品
- 新账号(注册<3天)不能交易(防止小号刷资源)

#### 6.4.2 拍卖行 (Phase 3)

**全局交易市场**:
- 玩家挂售物品,设置价格
- 其他玩家购买
- 平台抽取5%手续费

**价格发现**:
- 显示物品历史成交价
- 推荐定价

---

## 7. 视觉与音效设计

### 7.1 视觉风格指南

#### 7.1.1 地图视觉

**基础地图**:
- 使用Apple Maps标准地图
- 应用末日滤镜:
  - 饱和度 -20%
  - 对比度 +10%
  - 暖色调 (橙色色温)

**图层叠加**:
1. 其他玩家领地: 半透明灰色多边形(填充透明度30%)
2. 当前玩家领地: 金色边界(3px宽),半透明橙色填充(透明度20%)
3. POI标记: 彩色图标,带阴影
4. 建筑标记: 3D感图标,随缩放变化大小
5. 当前路径: 蓝色实线(4px宽),带外发光

**夜间模式**:
- 18:00-6:00自动切换深色地图
- 建筑灯光效果更明显
- UI元素高对比度

#### 7.1.2 UI设计

**主色调应用**:
- 主要按钮: 橙色渐变 (#FF6B35 → #FF8C42)
- 次要按钮: 深灰边框,透明填充
- 危险操作: 红色 (#E63946)
- 成功提示: 绿色 (#2A9D8F)

**字体规范**:
- 主标题: SF Pro Display, Bold, 24pt
- 副标题: SF Pro Display, Semibold, 18pt
- 正文: SF Pro Text, Regular, 14pt
- 小字: SF Pro Text, Regular, 12pt

**卡片设计**:
- 圆角: 12px
- 阴影: 0px 4px 12px rgba(0,0,0,0.15)
- 背景: 半透明白色/黑色(根据浅色/深色模式)

**图标风格**:
- 扁平化线性图标
- 2px线宽
- 圆角端点
- 统一的图标库(SF Symbols优先)

#### 7.1.3 建筑视觉

**建造中状态**:
- 灰色剪影
- 环形进度条(橙色)
- 显示剩余时间

**建造完成状态**:
- 彩色完整图标
- 轻微上下浮动动画(呼吸效果)
- 点击时放大动画

**建筑等级区分**:
- 1级: 基础图标
- 2级: 图标+金色边框
- 3级: 图标+金色边框+光芒特效

### 7.2 音效设计

#### 7.2.1 背景音乐

**主菜单音乐**:
- 风格: 氛围感电子乐 + 希望感旋律
- 情绪: 苍凉中带有希望
- 时长: 3分钟循环
- 参考: 《辐射4》主题曲 + 《最后生还者》配乐

**游戏内音乐**:
- 探索时: 轻柔的环境音 + 远处风声
- 圈地成功: 振奋的胜利音效(短暂)
- 建造时: 机械声 + 建造音效
- 夜间: 更柔和的钢琴旋律

**音乐音量控制**:
- 默认音量: 30%
- 玩家可在设置中调整
- 进入后台自动静音

#### 7.2.2 音效 (SFX)

**UI交互音效**:
| 操作 | 音效 |
|------|------|
| 按钮点击 | 轻微的"哔"声 |
| 选项卡切换 | 轻微的"哒"声 |
| 弹窗出现 | "咻"上升音 |
| 错误提示 | "咚"低沉音 |

**游戏玩法音效**:
| 操作 | 音效 |
|------|------|
| 开始圈地 | GPS启动音 + 提示音 |
| 圈地成功 | 胜利音效 + 欢呼声 |
| 圈地失败 | 沉重的"咚"声 |
| 搜刮废墟 | 翻找声 + 物品获得音 |
| 建造开始 | 锤子敲击声 |
| 建造完成 | 成功音效 + 短音乐 |
| 收集资源 | "叮"声 + 物品飞入音 |

**环境音效** (可选,默认关闭):
- 风声
- 鸟鸣(白天)
- 蛐蛐声(夜晚)
- 远处的机械声

#### 7.2.3 语音 (Phase 2)

使用AI语音合成(ElevenLabs)为关键NPC生成对话:

**引导NPC - "指挥官"**:
- 声音特征: 中年男性,沉稳有力
- 使用场景: 新手引导,重要提示

**广播员 - "希望之声电台"**:
- 声音特征: 年轻女性,充满活力
- 使用场景: 每日任务播报,世界事件通知

### 7.3 动画设计

#### 7.3.1 核心动画

**圈地成功动画**:
1. 路径闭合时,蓝色路径变为金色(0.5秒过渡)
2. 金色光芒从路径扩散到多边形内部(1秒)
3. 多边形边界出现,从透明渐变到金色(0.5秒)
4. 中心显示"圈地成功!"文字,带缩放动画(0.3秒)
5. 显示领地面积和奖励(淡入,0.5秒)

**建筑建造完成动画**:
1. 进度条填满,变为绿色(0.3秒)
2. 灰色图标变为彩色(0.5秒淡入)
3. 金色光芒从建筑中心向外扩散(1秒)
4. 显示"建造完成!"浮动文字(向上飘,2秒后消失)

**资源获得动画**:
1. 物品图标从废墟位置飞出(抛物线)
2. 飞向屏幕右上角背包图标(1秒)
3. 背包图标短暂放大+震动(0.3秒)
4. 显示"+5废料"浮动文字

#### 7.3.2 过渡动画

**页面切换**:
- 淡入淡出(0.3秒)
- 避免过于花哨的转场(耗电)

**地图缩放**:
- 平滑缩放动画(0.4秒)
- 图标根据缩放级别逐渐显示/隐藏

**列表滚动**:
- 惯性滚动
- 下拉刷新动画(旋转图标)

---

## 8. 技术方案

### 8.1 技术栈

#### 8.1.1 客户端

**平台**: iOS 15.0+

**核心技术**:
- **语言**: Swift 5.9+
- **UI框架**: SwiftUI
- **地图**: Apple MapKit
- **位置服务**: Core Location
- **本地存储**: SwiftData
- **网络**: Supabase Swift SDK

**架构模式**:
- MVVM (Model-View-ViewModel)
- Repository Pattern (数据层抽象)
- Coordinator Pattern (导航管理,Phase 2)

#### 8.1.2 后端

**平台**: Supabase

**核心服务**:
- **数据库**: PostgreSQL 15+ with PostGIS extension
- **认证**: Supabase Auth (Apple Sign In, Email/Password)
- **服务端逻辑**: Supabase Edge Functions (Deno/TypeScript)
- **实时通信**: Supabase Realtime (WebSocket)
- **文件存储**: Supabase Storage

**优势**:
- 开源,免费tier慷慨
- PostGIS地理空间查询强大
- 内置Auth和Realtime
- Edge Functions全球分布式部署

### 8.2 关键技术难点与解决方案

#### 8.2.1 领地碰撞检测性能

**挑战**:
- 需要检测新路径是否与数千个现有领地相交
- 实时计算会导致服务器压力大

**解决方案**:
1. **空间索引**: 使用PostGIS的GIST索引
   ```sql
   CREATE INDEX idx_territories_area ON territories USING GIST(area);
   ```
2. **范围预过滤**: 只检测用户周围10km内的领地
   ```sql
   WHERE ST_DWithin(area::geography, ST_MakePoint($lng, $lat)::geography, 10000)
   ```
3. **异步验证**: 用户提交路径后,服务器后台验证,通过WebSocket推送结果
4. **缓存**: 缓存热点区域的领地数据(Redis,Phase 2)

#### 8.2.2 GPS定位精度与作弊

**挑战**:
- GPS在城市峡谷、室内精度差
- 玩家可能使用GPS模拟器作弊

**解决方案**:
1. **多传感器融合**:
   - GPS + 加速度计 + 陀螺仪
   - 检测步行特征(加速度模式)
2. **速度异常检测**:
   - 实时计算相邻点速度
   - 速度突变标记为异常
3. **行为分析**:
   - 圈地面积异常大(单次>5km²)触发审核
   - 短时间多次圈地限制
4. **容错设计**:
   - 允许20米闭环误差
   - 允许少量低精度点(<5%)

#### 8.2.3 电池消耗优化

**挑战**:
- 持续GPS定位耗电严重
- 后台运行时更甚

**解决方案**:
1. **动态采样频率**:
   - 开拓模式: 5秒/次
   - 正常模式: 不定位(节省电量)
2. **后台模式优化**:
   - 使用`allowsBackgroundLocationUpdates = true`
   - 但降低精度要求(`desiredAccuracy = kCLLocationAccuracyHundredMeters`)
3. **智能暂停**:
   - 检测到静止超过5分钟自动暂停定位
   - 移动时自动恢复
4. **能耗测试**:
   - 使用Xcode Instruments的Energy Log
   - 目标: 开拓模式1小时耗电<15%

#### 8.2.4 离线支持

**挑战**:
- 户外环境可能网络不稳定
- 需要保证圈地数据不丢失

**解决方案**:
1. **本地缓存**:
   - 使用SwiftData缓存地图数据、POI、领地
   - 离线时显示缓存数据
2. **轨迹本地存储**:
   - 圈地轨迹点先存本地
   - 有网络时再提交服务器验证
3. **队列重试**:
   - 失败的网络请求加入重试队列
   - 自动重试,最多3次
4. **冲突解决**:
   - 服务器端最终决定领地归属
   - 本地预验证只是提示(可能不准确)

### 8.3 数据库设计要点

**PostGIS地理类型**:
```sql
-- 领地使用Polygon
area GEOMETRY(Polygon, 4326)

-- 建筑/废墟使用Point
location GEOMETRY(Point, 4326)

-- 路径使用LineString
path GEOMETRY(LineString, 4326)
```

**关键查询**:
```sql
-- 检测碰撞
SELECT EXISTS (
    SELECT 1 FROM territories
    WHERE ST_Intersects(area, ST_GeomFromGeoJSON($new_path))
    AND user_id != $current_user_id
);

-- 查找附近废墟
SELECT * FROM ruins
WHERE ST_DWithin(
    location::geography,
    ST_MakePoint($lng, $lat)::geography,
    1000  -- 1km
)
ORDER BY location <-> ST_MakePoint($lng, $lat)::geography
LIMIT 20;
```

### 8.4 扩展性考虑

**用户量增长**:
- 当前架构支持10万DAU
- 超过后考虑:
  - 数据库分片(按地理区域)
  - CDN加速(图片资源)
  - Redis缓存层

**多平台支持**:
- Phase 2: Android版本
  - 复用Supabase后端
  - 使用Kotlin + Jetpack Compose
- Phase 3: Web版本
  - 查看地图和管理领地
  - 不支持圈地(需要移动设备)

---

## 9. 盈利模式

### 9.1 商业化理念

**核心原则**:
1. **免费用户完整体验** - 所有核心玩法100%免费可玩
2. **付费优化体验** - 付费减少时间成本,不影响公平性
3. **订阅长期价值** - 为深度玩家提供持续增值

**关键承诺**:
- 圈地系统100%公平(付费不增加圈地面积或成功率)
- 无强制广告
- 不会因为不付费而失去领地

### 9.2 三层付费体系

#### 9.2.1 免费用户 (Free Tier)

**完整游戏体验**:
- ✅ 圈地系统(无限次,无面积限制)
- ✅ 探索POI(每天20次)
- ✅ 建造系统(所有15种建筑类型)
- ✅ 物品系统(背包容量100格)
- ✅ 无线电通讯(3km本地频道)
- ✅ 所有成就可解锁
- ✅ 好友系统(50人上限)

**限制**:
- 探索次数有限(20次/天)
- 背包容量100格
- 无线电范围3km
- 建造速度正常

#### 9.2.2 内购用户 (IAP Tier)

**美化装饰类** (不影响游戏平衡):
- 角色外观包: $2.99-$9.99
  - "废土战士"套装
  - "拾荒猎人"套装
  - "重建先锋"套装
- 建筑皮肤包: $1.99-$4.99
  - "工业风"建筑皮肤
  - "生态绿洲"建筑皮肤
- 领地装饰: $0.99-$2.99
  - 定制领地边界颜色
  - 领地内装饰物(旗帜、路灯等)

**资源包** (减少搜刮时间,但不破坏平衡):
- 初级物资包: $0.99
  - 废料x50, 木材x30
  - 等价于探索5次
- 中级物资包: $2.99
  - 废料x150, 木材x100, 金属x30
  - 等价于探索15次
- 高级物资包: $4.99
  - 废料x300, 木材x200, 金属x80, 电子元件x20
  - 等价于探索30次

**便利道具**:
- 建筑加速器: $1.99
  - 立即完成1个建筑
  - 或减少50%建造时间
- 探索次数重置: $0.99
  - 重置当日探索次数

#### 9.2.3 订阅用户 (开拓者月卡 / Reclaimer Pass)

**定价**: $9.99/月 或 $99/年 (优惠17%)

**订阅权益**:

**探索增强**:
- POI探索范围翻倍(1km → 2km)
- 每天探索次数无限
- 稀有物品掉落率 +20%

**建造加速**:
- 建造速度 +100% (2小时建筑 → 1小时)
- 同时建造数量 +1 (正常1个,订阅2个)

**通讯特权**:
- 解锁区域频道(30km范围)
- 可创建私密频道
- 好友上限增加到200人

**资源优势**:
- 背包容量 +100格
- 建筑储存上限 +12小时(24h → 36h)

**视觉特权**:
- 专属称号边框(钻石边框)
- 领地金色高亮边界
- 每月赠送1个建筑皮肤

**每月赠品**:
- 高级物资包 x1
- 建筑加速器 x5

### 9.3 付费转化策略

#### 9.3.1 转化漏斗

```
新用户注册
    ↓ (100%)
完成新手引导
    ↓ (70%)
第一次圈地成功
    ↓ (50%)
建造第一个建筑
    ↓ (40%)
达到探索次数上限 → **付费触点1**
    ↓ (10% → 内购/订阅)
需要加速建造 → **付费触点2**
    ↓ (5% → 内购)
想要更大通讯范围 → **付费触点3**
    ↓ (15% → 订阅)
```

#### 9.3.2 付费触点设计

**付费触点1: 探索次数上限**
- 时机: 玩家当日第20次探索后
- 提示: "今日探索次数已用完!订阅开拓者月卡解锁无限探索"
- 转化率目标: 8-10%

**付费触点2: 建造等待**
- 时机: 玩家建造一个6小时+的建筑后
- 提示: "等待太久?使用建筑加速器立即完成!"
- 转化率目标: 3-5%

**付费触点3: 无线电范围**
- 时机: 玩家尝试与4km外玩家联系时
- 提示: "该玩家距离太远,订阅解锁30km区域频道"
- 转化率目标: 12-15%

**付费触点4: 背包已满**
- 时机: 背包接近100格上限
- 提示: "背包快满了!建造仓库或订阅增加容量"
- 转化率目标: 5-8%

#### 9.3.3 限时优惠

**新用户优惠**:
- 注册后24小时内,首次订阅7折
- 限时弹窗提示

**节日活动**:
- 圣诞节: 资源包双倍
- 新年: 订阅送专属称号

### 9.4 收入预测

#### 9.4.1 用户规模假设 (12个月后)

| 指标 | 数值 |
|------|------|
| MAU (月活跃用户) | 12,000 |
| DAU (日活跃用户) | 3,600 |
| 付费率 | 35% |
| 其中订阅占比 | 20% (2,400人) |
| 其中内购占比 | 15% (1,800人) |

#### 9.4.2 收入构成 (月)

**订阅收入**:
- 2,400人 × $9.99/月 × 70%留存 = **$16,780/月**

**内购收入**:
- 1,800人 × $3平均消费/月 = **$5,400/月**

**总收入**: **$22,180/月** 或 **$266,160/年**

#### 9.4.3 成本估算

| 成本项 | 月费用 | 年费用 |
|--------|--------|--------|
| Supabase Pro | $25 | $300 |
| Apple开发者账号 | $8.25 | $99 |
| AI服务(千问API) | $50 | $600 |
| CDN/存储 | $30 | $360 |
| **总计** | **$113.25** | **$1,359** |

**净利润** (12个月后): $266,160 - $1,359 = **$264,801/年**

---

## 10. 开发路线图

### 10.1 Phase 1: 核心MVP (3个月)

**目标**: 验证圈地+建造的核心循环

**功能列表**:
- ✅ 用户认证(Apple Sign In + Email)
- ✅ 圈地系统(GPS轨迹记录,服务器验证)
- ✅ 地图显示(领地、POI可视化)
- ✅ 探索系统(搜刮废墟,获得资源)
- ✅ 物品系统(背包管理)
- ✅ 建造系统(15种建筑)
- ✅ 资源生产与收集
- ✅ 无线电通讯(本地频道)
- ✅ 成就系统
- ✅ 新手引导

**里程碑**:
- M1 (Week 4): 圈地系统可用
- M2 (Week 8): 建造系统可用
- M3 (Week 12): MVP完整,提交TestFlight

### 10.2 Phase 2: 社交与优化 (3个月)

**目标**: 增强社交互动,提升留存

**功能列表**:
- ✅ 好友系统
- ✅ 联盟系统
- ✅ 交易系统(玩家间交易)
- ✅ 建筑升级系统
- ✅ 合成系统
- ✅ 区域频道(30km,订阅)
- ✅ AI生成NPC对话
- ✅ 性能优化(电池、网络)

**里程碑**:
- M4 (Week 16): 好友和联盟系统
- M5 (Week 20): 交易系统
- M6 (Week 24): 提交App Store正式版

### 10.3 Phase 3: 深度内容 (6个月)

**目标**: 增加游戏深度,延长生命周期

**功能列表**:
- ✅ 世界事件(动态任务)
- ✅ PVE战斗系统(怪物)
- ✅ 任务系统(NPC任务)
- ✅ 科技树系统
- ✅ 稀有装备系统
- ✅ 联盟战争(领地争夺)
- ✅ 拍卖行(全局交易)

**里程碑**:
- M7 (Week 36): 世界事件和PVE
- M8 (Week 48): 任务和科技树系统

### 10.4 Phase 4: 商业化与跨平台 (持续)

**目标**: 扩大用户规模,提升收入

**功能列表**:
- ✅ 完整内购系统
- ✅ 订阅优化(多档位)
- ✅ 限时活动
- ✅ Android版本
- ✅ Web管理后台
- ✅ 数据分析优化
- ✅ 广告变现(可选)

---

## 11. 结语

《地球新主》不仅是一款游戏,更是对"重建"这一人类永恒主题的探索。在虚拟的废土世界中,玩家通过双脚丈量土地,用双手重建家园,这与现实世界中我们每个人的奋斗何其相似。

我们希望这款游戏能:
- 激励玩家走出家门,拥抱阳光和运动
- 提供有深度的策略体验,而非无脑点击
- 创造真实的社交联结,而非虚假的"社交"
- 展现末世中的希望,而非绝望

**核心设计哲学**:
> "在最黑暗的时刻,人性的光辉最耀眼。"

这就是《地球新主》想要讲述的故事。

---

**文档结束**

**批准签字**:

| 角色 | 姓名 | 签名 | 日期 |
|------|------|------|------|
| 游戏总监 | | | |
| 美术总监 | | | |
| 技术总监 | | | |

**文档版本历史**:

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|---------|------|
| 1.0 | 2026-01-03 | 初始版本,完整GDD | |
