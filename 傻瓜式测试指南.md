# 🎯 傻瓜式圈地测试指南（5分钟完成）

## 📱 第一步：准备 App（1分钟）

### 1.1 确保 App 正在运行
- 看你的屏幕上，模拟器（iPhone）应该已经打开了
- 如果没打开，在 Xcode 中按 `cmd + R` 运行

### 1.2 进入地图 Tab
- 在 App 底部，点击 **第一个 Tab**（地图图标）
- 你应该看到一个地图界面

### 1.3 检查定位
- 看地图顶部，应该有一个黑色横条
- 如果显示 **"定位未授权"**：
  1. 点击下方的蓝色按钮「授权定位」
  2. 在弹窗中选择「使用 App 时允许」

- 如果显示 **"定位中..."** 或一串坐标：
  ✅ 说明定位正常，继续下一步

---

## 🗺️ 第二步：设置初始位置（30秒）

### 2.1 在模拟器菜单栏设置位置

**在模拟器窗口（不是 Xcode）** 的顶部菜单：

```
Features → Location → Custom Location...
```

### 2.2 输入坐标

会弹出一个窗口，输入：
```
Latitude:  39.9042
Longitude: 116.4074
```

点击 **OK**

### 2.3 验证位置设置成功

- 回到 App
- 看地图顶部的黑色横条
- 应该显示类似：`39.904200, 116.407400`
- ✅ 如果看到这个坐标，说明位置设置成功！

---

## 🚀 第三步：开始圈地（10秒）

### 3.1 点击圈地按钮

- 在地图界面，右下角有一个**大按钮**
- 按钮上写着 **「开始圈地」**
- **点击它！**

### 3.2 验证追踪已启动

点击后，按钮应该变成：
- 红色背景
- 文字变为 **「停止圈地 (1)」**
- 括号里的数字是已记录的点数

✅ 如果看到这个变化，说明追踪已经开始！

---

## 📝 第四步：查看日志界面（20秒）

### 4.1 切换到「更多」Tab

- 点击 App 底部 **第四个 Tab**（三个点的图标）

### 4.2 进入测试界面

- 点击列表中的 **「开发测试」**
- 再点击 **「圈地功能测试」**

### 4.3 验证日志正常

你应该看到：
- 顶部显示 **「● 追踪中」**（绿色圆点）
- 显示 **「1 个点」**
- 下方显示日志：
  ```
  [时间] [INFO] 开始圈地追踪
  [时间] [INFO] 记录第 1 个点（起点）
  ```

✅ 如果看到这些，说明日志系统正常工作！

---

## 🤖 第五步：自动化测试（3分钟）

### 5.1 打开终端

- 按 `cmd + 空格`
- 输入 `Terminal`（终端）
- 按回车

### 5.2 运行自动化脚本

在终端中**依次输入**以下命令（每输入一行按一次回车）：

```bash
cd /Users/yanshuangren/Desktop/EarthLord
```

然后：

```bash
./test_auto.sh
```

### 5.3 按照脚本提示操作

脚本会问你：
```
⚠️  请确保：
   1. 模拟器已经在运行 EarthLord App
   2. 已经点击了「开始圈地」按钮
   3. 打开了「圈地功能测试」日志界面

准备好了吗？按回车键继续...
```

**按回车键！**

### 5.4 观察自动测试过程

脚本会自动：
- 改变模拟器位置（11 个点）
- 每 3 秒一个点
- 总共约 30 秒

**你只需要看着日志界面！**

你应该看到日志**不断滚动**：
```
[时间] [INFO] 记录第 2 个点，距上点 15.5m
[时间] [INFO] 记录第 3 个点，距上点 15.5m
[时间] [INFO] 距起点 31.0m (需≤30m)
[时间] [INFO] 记录第 4 个点，距上点 15.5m
...
```

### 5.5 等待闭环和验证

当记录到第 11 个点时，你应该看到：

```
[时间] [SUCCESS] 闭环成功！距起点 2.2m
[时间] [INFO] 开始领地验证
[时间] [INFO] 点数检查: 11个点 ✓
[时间] [INFO] 距离检查: 160m ✓
[时间] [INFO] 自交检测: 无交叉 ✓
[时间] [INFO] 面积检查: 1600m² ✓
[时间] [SUCCESS] 领地验证通过！面积: 1600m²
```

### 5.6 查看成功横幅

- **切回地图 Tab**（App 底部第一个）
- 你应该看到一个 **绿色横幅**！
- 横幅上写着：**「✅ 圈地成功！领地面积: 1600m²」**
- 横幅会在 3 秒后自动消失

✅ **恭喜！测试成功！**

---

## ✅ 测试完成检查清单

测试成功后，你应该看到：

- [ ] 地图上显示了一个**正方形轨迹**（蓝色折线）
- [ ] 日志界面有完整的验证过程（点数、距离、自交、面积）
- [ ] 显示了绿色成功横幅
- [ ] 「停止圈地」按钮显示 **(11)** 个点

---

## 🐛 常见问题

### Q1: 脚本说"找不到模拟器"
**A:**
1. 确保模拟器窗口是打开的
2. 重新运行脚本

### Q2: 日志没有滚动
**A:**
1. 检查地图 Tab，「停止圈地」按钮的数字有没有增加
2. 如果数字不变，说明位置没有改变
3. 重新运行脚本

### Q3: 显示红色横幅
**A:**
- 这是正常的！红色横幅说明验证失败
- 看日志，应该有失败原因（例如"距离不足"）
- 这说明验证系统正常工作

### Q4: 没有显示横幅
**A:**
- 可能是点数不够（< 10 个点）
- 或者距离起点太远（> 30m）
- 看日志中有没有"闭环成功"

---

## 📸 期望看到的画面

### 画面 1：开始圈地后
```
┌─────────────────────────────┐
│ 地图 Tab                     │
├─────────────────────────────┤
│ 39.904200, 116.407400       │  ← 坐标显示
│                             │
│   [地图，有一个蓝点]          │
│                             │
│                             │
│               [停止圈地(1)]  │  ← 红色按钮，显示点数
└─────────────────────────────┘
```

### 画面 2：日志界面
```
┌─────────────────────────────┐
│ 圈地测试                     │
├─────────────────────────────┤
│ ● 追踪中  11 个点            │  ← 状态指示
├─────────────────────────────┤
│ [09:00:00] [INFO] 开始圈地  │
│ [09:00:03] [INFO] 记录第1点 │
│ [09:00:06] [INFO] 记录第2点 │
│ ...                         │  ← 日志滚动
│ [09:00:30] [SUCCESS] 闭环!  │
│ [09:00:30] [INFO] 验证通过  │
├─────────────────────────────┤
│  [清空]        [导出]        │
└─────────────────────────────┘
```

### 画面 3：成功横幅
```
┌─────────────────────────────┐
│ 地图 Tab                     │
├─────────────────────────────┤
│ ┌───────────────────────┐   │
│ │ ✅ 圈地成功！          │   │  ← 绿色横幅
│ │ 领地面积: 1600m²      │   │
│ └───────────────────────┘   │
│                             │
│   [地图，正方形轨迹]         │
│                             │
└─────────────────────────────┘
```

---

## 🎯 如果还是不懂

**直接告诉我你卡在哪一步了！**

例如：
- "我找不到 Features 菜单"
- "日志界面没有文字"
- "脚本运行后没反应"
- "我不知道终端在哪"

我会给你更详细的指导！
